{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst loader = document.querySelector('.loader');\nconst loader2 = document.querySelector('.loader2');\n\nexport function toggleLoader() {\n  loader.classList.toggle('visually-hidden');\n}\n\nexport function toggleLoader2() {\n  loader2.classList.toggle('visually-hidden');\n}\n\nexport async function searchImages(searchInput, page) {\n  const API_KEY = '43682309-decfbd59f0a24849675c6bf75';\n  if (page.currentPage === 1) {\n    toggleLoader();\n  } else {\n    toggleLoader2();\n  }\n  const response = await axios.get('https://pixabay.com/api/', {\n    params: {\n      key: API_KEY,\n      q: searchInput,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: 15,\n      page: page.currentPage,\n    },\n  });\n\n  page.currentPage += 1;\n  return response;\n}","export function createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        tags,\n        largeImageURL,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class='card'>\n        <a class=\"gallery-link\" href=\"${largeImageURL}\"><img class='image' src='${webformatURL}' alt='${tags}'></a>\n        <div class='description'>\n        <div class='title-text'><h4 class='title'>Likes</h4><p class='text'>${likes}</p></div>\n        <div class='title-text'><h4 class='title'>Views</h4><p class='text'>${views}</p></div>\n        <div class='title-text'><h4 class='title'>Comments</h4><p class='text'>${comments}</p></div>\n        <div class='title-text'><h4 class='title'>Downloads</h4><p class='text'>${downloads}</p></div>\n        </div>\n        </li>`\n    )\n    .join('');\n}","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { searchImages } from './js/pixabay-api.js';\nimport { toggleLoader } from './js/pixabay-api.js';\nimport { toggleLoader2 } from './js/pixabay-api.js';\nimport { createMarkup } from './js/render-functions.js';\n\nconst form = document.querySelector('.form');\nconst input = document.querySelector('.searchInput');\nconst list = document.querySelector('.list');\nconst submitBtn = document.querySelector('.submitBtn');\nconst loadMore = document.querySelector('.loadMore');\nconst page = { currentPage: 1 };\nsubmitBtn.disabled = true;\n\nfunction saveToLocalStorage(key, value) {\n  localStorage.setItem(key, value);\n}\n\nfunction getFromLocalStorage(key) {\n  const data = localStorage.getItem(key);\n  return data ? data : null;\n}\n\ninput.addEventListener('input', () => {\n  if (input.value.trim() !== '') {\n    submitBtn.disabled = false;\n  } else {\n    submitBtn.disabled = true;\n  }\n});\n\nform.addEventListener('submit', handleClick);\nloadMore.addEventListener('click', loadClick);\n\nasync function handleClick(event) {\n  event.preventDefault();\n  const searchInputValue = input.value.trim();\n  page.currentPage = 1;\n  if (searchInputValue !== '') {\n    list.innerHTML = '';\n    hideLoadMore();\n    saveToLocalStorage('searchInputValue', searchInputValue);\n    try {\n      const response = await searchImages(searchInputValue, page);\n      if (response.data.hits.length === 0) {\n        toggleLoader();\n        showErrorToast(\n          'Sorry, there are no images matching your search query. Please try again!'\n        );\n      } else {\n        toggleLoader();\n        list.insertAdjacentHTML('beforeend', createMarkup(response.data.hits));\n        lightbox.refresh();\n        const totalPages = Math.ceil(\n          response.data.totalHits / response.config.params.per_page\n        );\n        checkImageLoad(response, totalPages);\n      }\n      form.reset();\n      submitBtn.disabled = true;\n    } catch (error) {\n      toggleLoader();\n      showErrorToast(`${error}`);\n    }\n  }\n}\n\nasync function loadClick() {\n  hideLoadMore();\n  const searchInputValue = getFromLocalStorage('searchInputValue');\n  try {\n    const response = await searchImages(searchInputValue, page);\n    const totalPages = Math.ceil(\n      response.data.totalHits / response.config.params.per_page\n    );\n    toggleLoader2();\n    list.insertAdjacentHTML('beforeend', createMarkup(response.data.hits));\n    lightbox.refresh();\n    scroll();\n    checkImageLoad(response, totalPages);\n  } catch (error) {\n    toggleLoader2();\n    showErrorToast(`${error}`);\n  }\n}\n\nfunction scroll() {\n  const card = list.firstElementChild;\n  const height = card.getBoundingClientRect().height;\n  window.scrollBy({\n    top: height * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction showErrorToast(message) {\n  iziToast.error({\n    message: message,\n    position: 'topRight',\n    backgroundColor: '#EF4040',\n    messageColor: '#fff',\n    timeout: 3000,\n  });\n}\n\nfunction showWarningToast() {\n  iziToast.warning({\n    position: 'topRight',\n    backgroundColor: '#00A36C',\n    message: \"We're sorry, but you've reached the end of search results.\",\n  });\n}\n\nfunction showLoadMore() {\n  loadMore.classList.remove('visually-hidden');\n}\n\nfunction hideLoadMore() {\n  loadMore.classList.add('visually-hidden');\n}\n\nfunction checkImageLoad(response, totalPages) {\n  const checkImagesInterval = setInterval(() => {\n    const images = list.querySelectorAll('img');\n    const allImagesLoaded = [...images].every(img => img.complete);\n    if (allImagesLoaded) {\n      clearInterval(checkImagesInterval);\n      if (response.config.params.page >= totalPages) {\n        return showWarningToast();\n      } else {\n        showLoadMore();\n      }\n    }\n  }, 50);\n}\n\nconst lightbox = new SimpleLightbox('.list a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});"],"names":["loader","loader2","toggleLoader","toggleLoader2","searchImages","searchInput","page","API_KEY","response","axios","createMarkup","arr","webformatURL","tags","largeImageURL","likes","views","comments","downloads","form","input","list","submitBtn","loadMore","saveToLocalStorage","key","value","getFromLocalStorage","data","handleClick","loadClick","event","searchInputValue","hideLoadMore","showErrorToast","lightbox","totalPages","checkImageLoad","error","scroll","height","message","iziToast","showWarningToast","showLoadMore","checkImagesInterval","img","SimpleLightbox"],"mappings":"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"}